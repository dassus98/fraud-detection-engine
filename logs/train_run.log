2026-01-23 07:04:18,363 - INFO - Loading raw data...
2026-01-23 07:04:28,581 - INFO - Running feature engineering pipeline...
2026-01-23 07:04:28,581 - INFO - Starting feature pipeline on 590540 records...
2026-01-23 07:04:32,403 - INFO - Tier 1 & 2 calculations are complete.
2026-01-23 07:04:36,931 - INFO - Tier 3 calculations are complete.
2026-01-23 07:04:39,358 - INFO - Tier 4 calculations are complete.
2026-01-23 07:04:39,360 - INFO - Building graph...
2026-01-23 07:04:47,895 - INFO - Graph has been built: <bound method Graph.number_of_nodes of <networkx.classes.graph.Graph object at 0x74aad9ad23f0>> nodes, <bound method Graph.number_of_edges of <networkx.classes.graph.Graph object at 0x74aad9ad23f0>> edges.
2026-01-23 07:04:47,895 - INFO - Calculating components...
2026-01-23 07:04:48,771 - INFO - Mapping graph features...
2026-01-23 07:04:49,190 - INFO - Tier 5 calculations are complete.
2026-01-23 07:04:49,191 - INFO - Pipeline complete. Final shale: (590540, 451)
2026-01-23 07:04:50,530 - INFO - Shapes: X_train = (472432, 413), y_train = (472432,), X_val = (118108, 413), y_val = (118108,)
2026-01-23 07:04:50,530 - INFO - Initializing LightGBM model...
2026-01-23 07:04:50,530 - INFO - Training LightGBM model...
2026-01-23 07:05:16,422 - INFO - LightGBM training complete.
2026-01-23 07:05:16,426 - INFO - Evaluating business impact of the model...
2026-01-23 07:05:16,775 - INFO - Validation AUC: 0.9138
2026-01-23 07:05:16,808 - INFO - Optimal Decision Threshold: 0.580
2026-01-23 07:05:16,808 - INFO - Minimum Expected Cost per Transaction: 11.25
2026-01-23 07:05:16,809 - INFO - Final metrics: {'auc': 0.9138493071865201, 'optimal_threshold': np.float64(0.5800000000000001), 'cost_per_txn': np.float64(11.249872997595421)}
2026-01-23 07:05:16,809 - INFO - Saving model to models/lgbm_model_v1.pkl
2026-01-23 07:05:16,826 - INFO - Pipeline is complete.
2026-01-23 07:10:38,553 - INFO - Loading raw data...
2026-01-23 07:10:48,776 - INFO - Running feature engineering pipeline...
2026-01-23 07:10:48,776 - INFO - Starting feature pipeline on 590540 records...
2026-01-23 07:10:52,599 - INFO - Tier 1 & 2 calculations are complete.
2026-01-23 07:10:57,197 - INFO - Tier 3 calculations are complete.
2026-01-23 07:10:59,282 - INFO - Tier 4 calculations are complete.
2026-01-23 07:10:59,284 - INFO - Building graph...
2026-01-23 07:11:07,051 - INFO - Graph has been built: <bound method Graph.number_of_nodes of <networkx.classes.graph.Graph object at 0x791649dc5b80>> nodes, <bound method Graph.number_of_edges of <networkx.classes.graph.Graph object at 0x791649dc5b80>> edges.
2026-01-23 07:11:07,051 - INFO - Calculating components...
2026-01-23 07:11:07,918 - INFO - Mapping graph features...
2026-01-23 07:11:08,334 - INFO - Tier 5 calculations are complete.
2026-01-23 07:11:08,334 - INFO - Pipeline complete. Final shale: (590540, 451)
2026-01-23 07:11:09,825 - INFO - Shapes: X_train = (472432, 413), y_train = (472432,), X_val = (118108, 413), y_val = (118108,)
2026-01-23 07:11:09,826 - INFO - Initializing LightGBM model...
2026-01-23 07:11:09,826 - INFO - Training LightGBM model...
2026-01-23 07:11:36,222 - INFO - LightGBM training complete.
2026-01-23 07:11:36,224 - INFO - Evaluating business impact of the model...
2026-01-23 07:11:36,595 - INFO - Validation AUC: 0.9138
2026-01-23 07:11:36,627 - INFO - Optimal Decision Threshold: 0.580
2026-01-23 07:11:36,627 - INFO - Minimum Expected Cost per Transaction: 11.25
2026-01-23 07:11:36,628 - INFO - Final metrics: {'auc': 0.9138493071865201, 'optimal_threshold': np.float64(0.5800000000000001), 'cost_per_txn': np.float64(11.249872997595421)}
2026-01-23 07:11:36,628 - INFO - Stratified analysis...
2026-01-23 07:11:36,628 - INFO - Starting Stratified Analysis...
2026-01-23 07:13:57,271 - INFO - Loading raw data...
2026-01-23 07:14:07,528 - INFO - Running feature engineering pipeline...
2026-01-23 07:14:07,528 - INFO - Starting feature pipeline on 590540 records...
2026-01-23 07:14:11,858 - INFO - Tier 1 & 2 calculations are complete.
2026-01-23 07:14:16,901 - INFO - Tier 3 calculations are complete.
2026-01-23 07:14:20,542 - INFO - Tier 4 calculations are complete.
2026-01-23 07:14:20,544 - INFO - Building graph...
2026-01-23 07:14:29,623 - INFO - Graph has been built: <bound method Graph.number_of_nodes of <networkx.classes.graph.Graph object at 0x75eb1e3423f0>> nodes, <bound method Graph.number_of_edges of <networkx.classes.graph.Graph object at 0x75eb1e3423f0>> edges.
2026-01-23 07:14:29,624 - INFO - Calculating components...
2026-01-23 07:14:30,563 - INFO - Mapping graph features...
2026-01-23 07:14:31,041 - INFO - Tier 5 calculations are complete.
2026-01-23 07:14:31,041 - INFO - Pipeline complete. Final shale: (590540, 451)
2026-01-23 07:14:32,730 - INFO - Shapes: X_train = (472432, 413), y_train = (472432,), X_val = (118108, 413), y_val = (118108,)
2026-01-23 07:14:32,731 - INFO - Initializing LightGBM model...
2026-01-23 07:14:32,731 - INFO - Training LightGBM model...
2026-01-23 07:15:01,962 - INFO - LightGBM training complete.
2026-01-23 07:15:01,965 - INFO - Evaluating business impact of the model...
2026-01-23 07:15:02,417 - INFO - Validation AUC: 0.9138
2026-01-23 07:15:02,447 - INFO - Optimal Decision Threshold: 0.580
2026-01-23 07:15:02,448 - INFO - Minimum Expected Cost per Transaction: 11.25
2026-01-23 07:15:02,448 - INFO - Final metrics: {'auc': 0.9138493071865201, 'optimal_threshold': np.float64(0.5800000000000001), 'cost_per_txn': np.float64(11.249872997595421)}
2026-01-23 07:15:02,448 - INFO - Stratified analysis...
2026-01-23 07:15:02,448 - INFO - Starting Stratified Analysis...
2026-01-23 07:15:03,208 - INFO - 
       Segment  Count Fraud_Rate Cost_Per_Txn Total_Cost
  High (>$200)  18719       4.0%       $16.43   $307,575
    Low (<$50)  39767       4.0%       $10.80   $429,675
Med ($50-$200)  59622       2.9%        $9.92   $591,450
2026-01-23 07:15:03,228 - INFO - Saving model to models/lgbm_model_v1.pkl
2026-01-23 07:15:03,245 - INFO - Pipeline is complete.
